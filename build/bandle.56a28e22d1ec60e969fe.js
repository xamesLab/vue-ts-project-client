"use strict";(self.webpackChunkwebpack=self.webpackChunkwebpack||[]).push([[436],{997:(e,t,i)=>{i.d(t,{D:()=>s});class n{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:l(this,this._t0,o(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){let i=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,l(this,o(this,i=r(this,e,t)),i);break;default:l(this,this._t0,i=r(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function s(e){return function(t){return new n(t,e)}}function a(e){return e<0?-1:1}function r(e,t,i){let n=e._x1-e._x0,s=t-e._x1,r=(e._y1-e._y0)/(n||s<0&&-0),o=(i-e._y1)/(s||n<0&&-0),l=(r*s+o*n)/(n+s);return(a(r)+a(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(l))||0}function o(e,t){let i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function l(e,t,i){let n=e._x0,s=e._y0,a=e._x1,r=e._y1,o=(a-n)/1.5*(1-e._tension);e._context.bezierCurveTo(n+o,s+o*t,a-o,r-o*i,a,r)}},9884:(e,t,i)=>{i.d(t,{w:()=>s});class n{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:l(this,this._t0,o(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){[e,t]=[t,e];let i=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,l(this,o(this,i=r(this,e,t)),i);break;default:l(this,this._t0,i=r(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function s(e){function t(t){return new n(t,e)}return t.tension=function(e){return s(+e)},t}function a(e){return e<0?-1:1}function r(e,t,i){let n=e._x1-e._x0,s=t-e._x1,r=(e._y1-e._y0)/(n||s<0&&-0),o=(i-e._y1)/(s||n<0&&-0),l=(r*s+o*n)/(n+s);return(a(r)+a(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(l))||0}function o(e,t){let i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function l(e,t,i){let n=e._x0,s=e._y0,a=e._x1,r=e._y1,o=(a-n)/1.5*(1-e._tension);e._context.bezierCurveTo(s+o*t,n+o,r-o*i,a-o,r,a)}},4406:(e,t,i)=>{i.d(t,{H:()=>s});var n=i(4647);class s extends n.wC{_afterNew(){super._afterNewApplyThemes()}getFill(e){return{addColorStop:(e,t)=>{}}}_changed(){super._changed()}getBounds(e){const t=this.get("target");if(t){let i=t.globalBounds();const n=e.toLocal({x:i.left,y:i.top}),s=e.toLocal({x:i.right,y:i.top}),a=e.toLocal({x:i.right,y:i.bottom}),r=e.toLocal({x:i.left,y:i.bottom});return{left:Math.min(n.x,s.x,a.x,r.x),top:Math.min(n.y,s.y,a.y,r.y),right:Math.max(n.x,s.x,a.x,r.x),bottom:Math.max(n.y,s.y,a.y,r.y)}}return e._display.getLocalBounds()}}Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Gradient"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.wC.classNames.concat([s.className])})},9591:(e,t,i)=>{i.d(t,{W:()=>l});var n=i(4406),s=i(937),a=i(8379),r=i(3460),o=i(1050);class l extends n.H{getFill(e){const t=this.get("rotation",0);let i=this.getBounds(e),n=i.left||0,l=i.right||0,c=i.top||0,u=i.bottom||0,h=o.gn(t),d=o.F8(t),g=h*(l-n),f=d*(u-c),b=Math.max(g,f);const p=this._root._renderer.createLinearGradient(n,c,n+b*h,c+b*d),m=this.get("stops");if(m){let e=0;a.__(m,(t=>{let i=t.offset;r.Et(i)||(i=e/(m.length-1));let n=t.opacity;r.Et(n)||(n=1);let a=t.color;if(a){const e=t.lighten;e&&(a=s.Q1.lighten(a,e));const r=t.brighten;r&&(a=s.Q1.brighten(a,r)),p.addColorStop(i,"rgba("+a.r+","+a.g+","+a.b+","+n+")")}e++}))}return p}}Object.defineProperty(l,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LinearGradient"}),Object.defineProperty(l,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.H.classNames.concat([l.className])})},2563:(e,t,i)=>{i.d(t,{ArcDiagram:()=>Be,ArcDiagramLink:()=>Ge,ArcDiagramNodes:()=>Fe,Chord:()=>ae,ChordDirected:()=>oe,ChordLink:()=>ne,ChordLinkDirected:()=>re,ChordNodes:()=>ee,ChordNonRibbon:()=>le,Flow:()=>b,FlowLink:()=>ie,FlowNode:()=>J,FlowNodes:()=>q,Sankey:()=>Me,SankeyLink:()=>he,SankeyNodes:()=>ue});var n=i(1635),s=i(7140),a=i(6611),r=i(6377),o=i(820),l=i(8379),c=i(4350);class u extends s.S{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this.rule.bind(this);t("Flow").setAll({width:a.Q2,height:a.Q2,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,hiddenSize:.05,minSize:0,minHiddenValue:0}),t("FlowNodes").setAll({colors:r.e.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),t("FlowNode").setAll({setStateOnChildren:!0,cursorOverStyle:"pointer",toggleKey:"disabled"}),t("FlowNode").states.create("disabled",{}),t("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),t("Label",["flow"]).states.create("disabled",{fill:e.get("disabled")}),t("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),t("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),t("FlowLink",["source","unknown"]).setAll({}),t("FlowLink",["target","unknown"]).setAll({}),t("FlowNode").events.on("pointerover",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.__(e,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}));const i=t.get("incomingLinks");i&&l.__(i,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}))}let i=t.get("slice")||t.get("rectangle");i&&i.get("tooltipText")&&i.showTooltip()})),t("FlowNode").events.on("pointerout",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.__(e,(e=>{e.get("link").unhover()}));const i=t.get("incomingLinks");i&&l.__(i,(e=>{e.get("link").unhover()}))}})),t("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),t("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),t("RoundedRectangle",["shape"]).states.create("disabled",{fill:e.get("disabled")}),t("SankeyLink").setAll({controlPointDistance:.2}),t("FlowNode",["sankey"]).setAll({draggable:!0});{const i=t("Graphics",["sankey","link"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,o.w)(i,"fill",e,"grid")}t("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),t("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),t("Label",["sankey","horizontal"]).setAll({y:a.yP,centerY:a.yP,paddingLeft:15}),t("Label",["sankey","vertical"]).setAll({x:a.yP,centerX:a.yP,paddingTop:15}),t("Chord").setAll({radius:(0,a.KN)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"none"}),t("ChordDirected").setAll({linkHeadRadius:10}),t("ChordNodes").setAll({x:a.yP,y:a.yP}),t("FlowNode",["chord"]).setAll({draggable:!0}),t("ChordLink").setAll({sourceRadius:a.Q2,targetRadius:a.Q2,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),t("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),t("Slice",["shape"]).states.create("disabled",{fill:e.get("disabled")}),t("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),t("ChordLinkDirected").setAll({headRadius:10});{const i=t("Graphics",["chord","link","shape"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,o.w)(i,"fill",e,"grid"),(0,o.w)(i,"stroke",e,"grid")}t("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),t("ChordNonRibbon").setAll({linkType:"curve"}),t("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),t("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),t("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1}),t("ArcDiagram").setAll({orientation:"horizontal",nodePadding:5,minRadius:5,radiusKey:"sum",animationEasing:c.FD(c.tA)}),t("ArcDiagramNodes",["horizontal"]).setAll({y:a.Q2,centerY:a.Q2}),t("ArcDiagramNodes",["vertical"]).setAll({centerX:0}),t("Circle",["arcdiagram","node","shape"]).setAll({tooltipText:"{name}: {sum}"}),t("Circle",["arcdiagram","node","shape"]).states.create("disabled",{fill:e.get("disabled")});{const i=t("ArcDiagramLink",["link","shape"]);i.setAll({strokeOpacity:.15,strokeStyle:"solid",fillStyle:"none",isMeasured:!1}),(0,o.w)(i,"stroke",e,"grid")}t("ArcDiagramLink",["link","shape"]).states.create("hover",{strokeOpacity:1}),t("Label",["arcdiagram","node"]).setAll({text:"{name}",populateText:!0}),t("Label",["arcdiagram","horizontal"]).setAll({y:0,centerY:a.yP,centerX:a.Q2,rotation:-90}),t("Label",["arcdiagram","vertical"]).setAll({centerY:a.yP,centerX:a.Q2,paddingRight:15})}}var h=i(5905),d=i(1947),g=i(9591),f=i(3460);class b extends h.s{constructor(){super(...arguments),Object.defineProperty(this,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(d.m.new(this._root,{}))}),Object.defineProperty(this,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._defaultThemes.push(u.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),super._afterNew(),this.children.push(this.bulletsContainer)}processDataItem(e){super.processDataItem(e);const t=this.nodes;if(t){let i=!1,n=e.get("sourceId"),s=t.getDataItemById(n);s||(null==n&&(n="undefined"+this._index,this._index++,i=!0),t.data.push({id:n,unknown:i}),s=t.getDataItemById(n),i||s.set("name",n)),i=!1;let a=e.get("targetId"),r=t.getDataItemById(a);r||(null==a&&(a="undefined"+this._index,this._index++,i=!0),t.data.push({id:a,unknown:i}),r=t.getDataItemById(a),i||r.set("name",a)),s&&(e.set("source",s),t.addOutgoingLink(s,e)),r&&(e.set("target",r),t.addincomingLink(r,e)),e.set("link",this.makeLink(e));const o=this.nodes.dataItems.indexOf(s),l=this.nodes.dataItems.indexOf(r);this._linksByIndex[o+"_"+l]=e,s.get("unknown")&&(r&&s.set("fill",r.get("fill")),e.get("link").set("fillStyle","gradient")),r.get("unknown")&&(s&&r.set("fill",s.get("fill")),e.get("link").set("fillStyle","gradient")),this._updateLinkColor(e)}}_onDataClear(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}_prepareChildren(){super._prepareChildren();let e=1/0,t=-1/0,i=0;if(this._valuesDirty){this._nodesData=[];const n=this.nodes;n&&l.__(n.dataItems,(e=>{const t=e.get("d3SankeyNode");this._nodesData.push(t);const i=e.get("incomingLinks");let s=0,a=0;i&&l.__(i,(e=>{const t=e.get("value"),i=e.get("valueWorking");s+=t,a+=i})),e.set("sumIncoming",s),e.set("sumIncomingWorking",a);const r=e.get("outgoingLinks");let o=0,c=0;r&&l.__(r,(e=>{const t=e.get("value"),i=e.get("valueWorking");o+=t,c+=i})),e.set("sumOutgoing",o),e.set("sumOutgoingWorking",c),e.set("sum",s+o),e.set("sumWorking",a+c),n.updateLegendValue(e)})),this._linksData=[],l.__(this.dataItems,(n=>{let s=n.get("value");f.Et(s)&&(s<e&&(e=s),s>t&&(t=s),i+=s)})),l.__(this.dataItems,(e=>{let t=e.get("value");if(f.Et(t)){let t=e.get("valueWorking"),n=this.get("minSize",0);n>0&&t<n*i&&(t=n*i);let s={source:e.get("source").get("d3SankeyNode"),target:e.get("target").get("d3SankeyNode"),value:t};e.setRaw("d3SankeyLink",s),this._linksData.push(s),this.updateLegendValue(e)}})),this.setPrivateRaw("valueHigh",t),this.setPrivateRaw("valueLow",e),this.setPrivateRaw("valueSum",i)}}_updateLinkColor(e){const t=e.get("link"),i=t.get("fillStyle"),n=t.get("strokeStyle"),s=e.get("source"),a=e.get("target"),r=s.get("fill"),o=a.get("fill");switch(t.remove("fillGradient"),t.remove("strokeGradient"),i){case"solid":t._applyTemplates();break;case"source":t.set("fill",r);break;case"target":t.set("fill",o);break;case"gradient":let e=t._fillGradient;e||(e=g.W.new(this._root,{}));const i={color:r};s.get("unknown")&&(i.opacity=0);const n={color:o};a.get("unknown")&&(n.opacity=0),e.set("stops",[i,n]),t._fillGradient=e,t.set("fillGradient",e);break;case"none":t.set("fill",void 0)}switch(n){case"solid":t._applyTemplates();break;case"source":t.set("stroke",r);break;case"target":t.set("stroke",o);break;case"gradient":let e=t._strokeGradient;if(!e){e=g.W.new(this._root,{});const i={color:r};s.get("unknown")&&(i.opacity=0);const n={color:o};a.get("unknown")&&(n.opacity=0),e.set("stops",[i,n]),t._strokeGradient=e}t.set("strokeGradient",e);break;case"none":t.remove("stroke")}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("link");t&&(this.links.removeValue(t),t.dispose())}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.states.create("hidden",{}),a="stateAnimationDuration",r="stateAnimationEasing";f.Et(t)||(t=s.get(a,this.get(a,0)));const o=s.get(r,this.get(r));n.push(e.animate({key:"valueWorking",to:Math.max(this.get("minHiddenValue",0),this.get("hiddenSize",0)*e.get("value")),duration:t,easing:o}).waitForStop()),e.get("link").hide(),yield Promise.all(n)}))}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)];f.Et(t)||(t=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");n.push(e.animate({key:"valueWorking",to:e.get("value"),duration:t,easing:s}).waitForStop()),e.get("link").show(),yield Promise.all(n)}))}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=i.get("link"),n=e.get("sprite");if(n){const i=t.getPoint(this._getBulletLocation(e));n.setAll({x:i.x,y:i.y}),e.get("autoRotate")&&n.set("rotation",i.angle+e.get("autoRotateAngle",0))}}}}_getBulletLocation(e){return e.get("locationY",0)}}Object.defineProperty(b,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(b,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:h.s.classNames.concat([b.className])});var p=Math.abs,m=Math.cos,_=Math.sin,y=Math.PI,k=y/2,w=2*y,v=Math.max,x=1e-12;function P(e,t){return Array.from({length:t-e},((t,i)=>e+i))}function N(e,t){var i=0,n=null,s=null,a=null;function r(r){var o,l=r.length,c=new Array(l),u=P(0,l),h=new Array(l*l),d=new Array(l),g=0;r=Float64Array.from({length:l*l},t?(e,t)=>r[t%l][t/l|0]:(e,t)=>r[t/l|0][t%l]);for(let t=0;t<l;++t){let i=0;for(let n=0;n<l;++n)i+=r[t*l+n]+e*r[n*l+t];g+=c[t]=i}o=(g=v(0,w-i*l)/g)?i:w/l;{let t=0;n&&u.sort(((e,t)=>n(c[e],c[t])));for(const i of u){const n=t;if(e){const e=P(1+~l,l).filter((e=>e<0?r[~e*l+i]:r[i*l+e]));s&&e.sort(((e,t)=>s(e<0?-r[~e*l+i]:r[i*l+e],t<0?-r[~t*l+i]:r[i*l+t])));for(const n of e)n<0?(h[~n*l+i]||(h[~n*l+i]={source:null,target:null})).target={index:i,startAngle:t,endAngle:t+=r[~n*l+i]*g,value:r[~n*l+i]}:(h[i*l+n]||(h[i*l+n]={source:null,target:null})).source={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]};d[i]={index:i,startAngle:n,endAngle:t,value:c[i]}}else{const e=P(0,l).filter((e=>r[i*l+e]||r[e*l+i]));s&&e.sort(((e,t)=>s(r[i*l+e],r[i*l+t])));for(const n of e){let e;if(i<n?(e=h[i*l+n]||(h[i*l+n]={source:null,target:null}),e.source={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]}):(e=h[n*l+i]||(h[n*l+i]={source:null,target:null}),e.target={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]},i===n&&(e.source=e.target)),e.source&&e.target&&e.source.value<e.target.value){const t=e.source;e.source=e.target,e.target=t}}d[i]={index:i,startAngle:n,endAngle:t,value:c[i]}}t+=o}}return(h=Object.values(h)).groups=d,a?h.sort(a):h}return r.padAngle=function(e){return arguments.length?(i=v(0,e),r):i},r.sortGroups=function(e){return arguments.length?(n=e,r):n},r.sortSubgroups=function(e){return arguments.length?(s=e,r):s},r.sortChords=function(e){return arguments.length?(null==e?a=null:(t=e,a=function(e,i){return t(e.source.value+e.target.value,i.source.value+i.target.value)})._=e,r):a&&a._;var t},r}var D=i(4083),L=Array.prototype.slice;function A(e){return function(){return e}}function I(e){return e.source}function O(e){return e.target}function j(e){return e.radius}function T(e){return e.startAngle}function S(e){return e.endAngle}function C(){return 0}function M(){return 10}function R(e){var t=I,i=O,n=j,s=j,a=T,r=S,o=C,l=null;function c(){var c,u=t.apply(this,arguments),h=i.apply(this,arguments),d=o.apply(this,arguments)/2,g=L.call(arguments),f=+n.apply(this,(g[0]=u,g)),b=a.apply(this,g)-k,y=r.apply(this,g)-k,w=+s.apply(this,(g[0]=h,g)),v=a.apply(this,g)-k,P=r.apply(this,g)-k;if(l||(l=c=(0,D.Ae)()),d>x&&(p(y-b)>2*d+x?y>b?(b+=d,y-=d):(b-=d,y+=d):b=y=(b+y)/2,p(P-v)>2*d+x?P>v?(v+=d,P-=d):(v-=d,P+=d):v=P=(v+P)/2),l.moveTo(f*m(b),f*_(b)),l.arc(0,0,f,b,y),b!==v||y!==P)if(e){var N=w-+e.apply(this,arguments),A=(v+P)/2;l.quadraticCurveTo(0,0,N*m(v),N*_(v)),l.lineTo(w*m(A),w*_(A)),l.lineTo(N*m(P),N*_(P))}else l.quadraticCurveTo(0,0,w*m(v),w*_(v)),l.arc(0,0,w,v,P);if(l.quadraticCurveTo(0,0,f*m(b),f*_(b)),l.closePath(),c)return l=null,c+""||null}return e&&(c.headRadius=function(t){return arguments.length?(e="function"==typeof t?t:A(+t),c):e}),c.radius=function(e){return arguments.length?(n=s="function"==typeof e?e:A(+e),c):n},c.sourceRadius=function(e){return arguments.length?(n="function"==typeof e?e:A(+e),c):n},c.targetRadius=function(e){return arguments.length?(s="function"==typeof e?e:A(+e),c):s},c.startAngle=function(e){return arguments.length?(a="function"==typeof e?e:A(+e),c):a},c.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:A(+e),c):r},c.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:A(+e),c):o},c.source=function(e){return arguments.length?(t=e,c):t},c.target=function(e){return arguments.length?(i=e,c):i},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}function F(){return R()}function G(){return R(M)}function B(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function W(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}i(3447);const{abs:E,max:H,min:z}=Math;function Y(e){return{type:e}}function V(e,t,i){this.k=e,this.x=t,this.y=i}["w","e"].map(Y),["n","s"].map(Y),["n","w","e","s","nw","ne","sw","se"].map(Y),V.prototype={constructor:V,scale:function(e){return 1===e?this:new V(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new V(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new V(1,0,0),V.prototype;var Q=i(7742),X=i(100),K=i(7716);class J extends d.m{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}Object.defineProperty(J,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(J,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:d.m.classNames.concat([J.className])});class q extends h.s{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>K.J._new(this._root,{themeTags:["flow"]},[this.labels.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>J._new(this._root,{themeTags:["node"]},[this.nodes.template])))}),Object.defineProperty(this,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),super._afterNew()}_onDataClear(){const e=this.get("colors");e&&e.reset(),this._userDataSet=!0}processDataItem(e){if(super.processDataItem(e),e.setRaw("d3SankeyNode",{name:e.get("id"),dataItem:e}),null==e.get("fill")){let t=this.get("colors");t&&e.setRaw("fill",t.next())}const t=this.makeNode(e);e.setRaw("node",t);const i=this.get("disabledField");if(i){const t=e.dataContext;t&&t[i]&&this.root.events.once("frameended",(()=>{this.disableDataItem(e,0)}))}}makeNode(e,t){const i=this.nodes.make();return this.nodes.push(i),t&&i.addTag(t),e.get("unknown")&&i.addTag("unknown"),this.children.push(i),i._setDataItem(e),i.series=this,i.events.on("click",(e=>{const t=e.target;if("disabled"==t.get("toggleKey")){const e=t.dataItem;e&&(e.isHidden()?this.enableDataItem(e):this.disableDataItem(e))}})),e.on("fill",(()=>{this._updateNodeColor(e)})),e.set("node",i),i}_updateNodeColor(e){}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("node");t&&(this.nodes.removeValue(t),t.dispose());let i=e.get("label");i&&(this.labels.removeValue(i),i.dispose())}addincomingLink(e,t){let i=e.get("incomingLinks");i||(i=[],e.set("incomingLinks",i)),i.push(t)}addOutgoingLink(e,t){let i=e.get("outgoingLinks");i||(i=[],e.set("outgoingLinks",i)),i.push(t)}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&i.show();let n=e.get("label");n&&n.show(t);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.showDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.showDataItem(e,t)}))}yield n}))}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&i.hide();let n=e.get("label");n&&n.hide(t);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.hideDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.hideDataItem(e,t)}))}yield n}))}enableDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&this.root.events.once("frameended",(()=>{i.set("disabled",!1)}));let n=e.get("label");n&&n.set("disabled",!1);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.showDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.showDataItem(e,t)}))}yield n}))}disableDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&this.root.events.once("frameended",(()=>{i.set("disabled",!0)}));let n=e.get("label");n&&n.set("disabled",!0);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.hideDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.hideDataItem(e,t)}))}yield n}))}}Object.defineProperty(q,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty(q,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:h.s.classNames.concat([q.className])});var U=i(9460),Z=i(5269),$=i(1050);class ee extends q{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>Z.i._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>U.J._new(this._root,{themeTags:["shape"]},[this.slices.template])))}),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:this.slices})}makeNode(e){const t=super.makeNode(e,"chord"),i=t.children.insertIndex(0,this.slices.make());e.set("slice",i),i._setSoft("fill",e.get("fill"));const n=this.labels.make();return this.labels.push(n),n.addTag("flow"),n.addTag("chord"),n.addTag("node"),t.children.push(n),e.set("label",n),t.events.on("dragstart",(e=>{let t=this.toLocal(e.point);const i=$._H({x:0,y:0},t);this.flow&&(this._dAngle=this.flow.get("startAngle",0)-i)})),t.events.on("dragged",(e=>{let i=this.toLocal(e.point);const n=$._H({x:0,y:0},i);t.setAll({x:0,y:0}),this.flow&&this.flow.set("startAngle",n+this._dAngle)})),n._setDataItem(e),i._setDataItem(e),t}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=e.get("sprite");if(t){const n=i.get("slice"),s=e.get("locationX",.5),a=e.get("locationY",.5);if(n){const e=n.get("radius",0),i=n.get("innerRadius",0),r=i+(e-i)*a,o=n.get("startAngle",0)+n.get("arc",0)*s;t.setAll({x:r*$.gn(o),y:r*$.F8(o)})}}}}}_updateNodeColor(e){const t=e.get("slice");t&&t.set("fill",e.get("fill"))}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("slice");t&&(this.slices.removeValue(t),t.dispose())}}Object.defineProperty(ee,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(ee,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([ee.className])});var te=i(5557);class ie extends te.A{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_changed(){if(super._changed(),this.isDirty("fillStyle")){const e=this.series,t=this.dataItem;e&&t&&e._updateLinkColor(t)}}_getTooltipPoint(){let e=this.get("tooltipY"),t=.5;return e instanceof a.QE&&(t=e.value),this.getPoint(t)}}Object.defineProperty(ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.A.classNames.concat([ie.className])});class ne extends ie{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getPoint(e){if(this._p0&&this._p1){if("line"===this._type){let t=$.Md(this._p0,this._p1,e);return{x:t.x,y:t.y,angle:$._H(this._p0,this._p1)}}{let t=$.DW(this._p0,this._p1,{x:0,y:0},Math.max(0,e-.01)),i=$.DW(this._p0,this._p1,{x:0,y:0},Math.min(1,e+.01)),n=$.DW(this._p0,this._p1,{x:0,y:0},e);return{x:n.x,y:n.y,angle:$._H(t,i)}}}return{x:0,y:0,angle:0}}}Object.defineProperty(ne,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(ne,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ie.classNames.concat([ne.className])});var se=i(8135);class ae extends b{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>ne._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ee.new(this._root,{}))}),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:N(!1,!1)}),Object.defineProperty(this,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:F()})}_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:a.yP,y:a.yP}),this.bulletsContainer.setAll({x:a.yP,y:a.yP}),super._afterNew()}_fixRibbon(e){e.startAngle((e=>e.startAngle+this.get("startAngle",0)*$.nr+Math.PI/2)),e.endAngle((e=>e.endAngle+this.get("startAngle",0)*$.nr+Math.PI/2))}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_makeMatrix(){const e=[];return l.__(this.nodes.dataItems,(t=>{const i=[];e.push(i);let n=t.get("outgoingLinks");l.__(this.nodes.dataItems,(e=>{let t=0;n&&l.__(n,(i=>{i.get("target")===e&&(t=i.get("valueWorking"));let n=this.getPrivate("valueSum",0),s=this.get("minSize",0);t>0&&s>0&&t<n*s&&(t=n*s)})),i.push(t)}))})),e}_prepareChildren(){super._prepareChildren(),this._fixRibbon(this._ribbon);let e=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){const t=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*$.nr);const i=this.get("sort");"ascending"===i?this._d3chord.sortGroups(B):"descending"===i&&this._d3chord.sortGroups(W),this._chordLayout=this._d3chord(t),e=!0}if(e||this.isDirty("radius")||this.isDirty("nodeWidth")){let e=se.JY(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,t=0;const i=this.get("startAngle",0),n=this.get("nodeWidth",0);l.__(this.nodes.dataItems,(s=>{const a=s.get("slice"),r=this._chordLayout.groups[t],o=r.startAngle*$.iR+i,l=r.endAngle*$.iR+i;a.setAll({radius:e,innerRadius:e-n,startAngle:o,arc:l-o});const c=s.get("label");c.setAll({labelAngle:o+(l-o)/2}),c.setPrivate("radius",e),c.setPrivate("innerRadius",.1),t++}));const s=e-this.get("nodeWidth",0);l.__(this._chordLayout,(e=>{let t=this._linksByIndex[e.source.index+"_"+e.target.index];if(t||(t=this._linksByIndex[e.target.index+"_"+e.source.index]),t){const i=t.get("link");this._getLinkPoints(i,s,e),this._updateLink(this._ribbon,i,s,e)}}))}}_getLinkPoints(e,t,i){const n=i.source,s=i.target,a=this.get("startAngle",0)*$.nr;if(n&&s){const i=n.startAngle,r=i+(n.endAngle-i)/2+a,o=s.startAngle,l=o+(s.endAngle-o)/2+a;e._p0={x:t*Math.cos(r),y:t*Math.sin(r)},e._p1={x:t*Math.cos(l),y:t*Math.sin(l)}}}_updateLink(e,t,i,n){n&&(e.sourceRadius(se.JY(t.get("sourceRadius",a.Q2),i)),e.targetRadius(se.JY(t.get("targetRadius",a.Q2),i)),t.set("draw",(t=>{e.context(t),e(n)})))}}Object.defineProperty(ae,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(ae,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:b.classNames.concat([ae.className])});class re extends ne{_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["chord","link","directed"]),super._afterNew()}}Object.defineProperty(re,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(re,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.classNames.concat([re.className])});class oe extends ae{constructor(){super(...arguments),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:N(!0,!1)}),Object.defineProperty(this,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:G()}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>re._new(this._root,{themeTags:["link","shape"]},[this.links.template])))})}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["directed"]),super._afterNew(),this._markDirtyKey("linkHeadRadius")}_prepareChildren(){const e="linkHeadRadius";if(this.isDirty(e)){const t=this.get(e);if(null==t)this._ribbon=F();else{let e=G();e.headRadius(t),this._ribbon=e}}super._prepareChildren()}}Object.defineProperty(oe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(oe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ae.classNames.concat([oe.className])});class le extends ae{_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["chord","basic"]),super._afterNew()}_makeMatrix(){const e=[];return l.__(this.nodes.dataItems,(t=>{const i=[];e.push(i),l.__(this.nodes.dataItems,(e=>{let n=1;t===e&&(n=0),i.push(n)}))})),e}_updateLink(e,t,i,n){if(t._type=this.get("linkType"),n){const e=this.get("linkType");t.set("draw",(i=>{let n=t._p0,s=t._p1;n&&s&&(i.moveTo(n.x,n.y),"line"==e?i.lineTo(s.x,s.y):i.quadraticCurveTo(0,0,s.x,s.y))}))}}_getLinkPoints(e,t,i){const n=e.get("source"),s=e.get("target");if(n&&s){const i=n.get("slice"),a=s.get("slice"),r=i.get("startAngle",0)+i.get("arc",0)/2,o=a.get("startAngle",0)+a.get("arc",0)/2;e._p0={x:t*$.gn(r),y:t*$.F8(r)},e._p1={x:t*$.gn(o),y:t*$.F8(o)}}}}Object.defineProperty(le,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(le,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ae.classNames.concat([le.className])});var ce=i(6026);class ue extends q{constructor(){super(...arguments),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>ce.T._new(this._root,{themeTags:["shape"]},[this.rectangles.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeNode(e){const t=this.flow,i=super.makeNode(e,"sankey"),n=i.children.insertIndex(0,this.rectangles.make());this.rectangles.push(n),n._setSoft("fill",e.get("fill")),e.set("rectangle",n),i.events.on("dragged",(()=>{const e=i.dataItem.get("d3SankeyNode");e&&t&&("horizontal"==t.get("orientation")?(e.x0=i.x(),e.y0=i.y()):(e.x0=i.y(),e.y0=i.x()),t.updateSankey())}));const s=this.labels.make();return this.labels.push(s),t&&s.addTag(t.get("orientation","")),i.children.push(s),e.set("label",s),s._setDataItem(e),n._setDataItem(e),i}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=e.get("sprite");if(t){const n=i.get("rectangle"),s=i.get("node"),a=e.get("locationX",.5),r=e.get("locationY",.5);n&&t.setAll({x:s.x()+n.width()*a,y:s.y()+n.height()*r})}}}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("rectangle");t&&(this.rectangles.removeValue(t),t.dispose())}_updateNodeColor(e){const t=e.get("rectangle");t&&t.set("fill",e.get("fill"))}}Object.defineProperty(ue,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(ue,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([ue.className])});class he extends ie{constructor(){super(...arguments),Object.defineProperty(this,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(this,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const e=this.get("source");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isDirty("target")){const e=this.get("target");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isPrivateDirty("orientation")){const e=this.series,t=this.dataItem;t&&e&&e._updateLinkColor(t)}const e=this.get("target"),t=this.get("source");let i,n;if(t&&e){this._clear=!0,i=t.get("node"),n=e.get("node");let s=0,a=0,r=0,o=0,l=0,c=0,u=0,h=0,d=0,g=0,f=0,b=0,p=0,m=0,_=0,y=0,k=0,w=0;const v=this.dataItem;if(v){const x=v.get("d3SankeyLink");if(x){let v=x.width||0,P=this.getPrivate("orientation");"vertical"==P?(i&&(r=i.y()+i.get("dy",0)),n&&(o=n.y()+n.get("dy",0)),k=90,w=90,s=x.y0||0,a=x.y1||0,s+=i.get("dx",0),a+=n.get("dx",0),o<r&&([s,a]=[a,s],[r,o]=[o,r]),t.get("unknown")&&(s=a,r+=(o-r)/2),e.get("unknown")&&(a=s,o=r+(o-r)/2),l=s-v/2,c=r,u=a-v/2,h=o,d=s+v/2,g=a+v/2,f=r,b=o,p=s,m=a,_=r,y=o):(i&&(s=i.x()+i.get("dx",0)),n&&(a=n.x()+n.get("dx",0)),r=x.y0||0,o=x.y1||0,r+=i.get("dy",0),o+=n.get("dy",0),a<s&&([s,a]=[a,s],[r,o]=[o,r]),t.get("unknown")&&(r=o,s+=(a-s)/2),e.get("unknown")&&(o=r,a=s+(a-s)/2),l=s,c=r-v/2,u=a,h=o-v/2,d=s,g=a,f=r+v/2,b=o+v/2,p=s,m=a,_=r,y=o),$.LI(l,3)==$.LI(u,3)&&(u+=.01),$.LI(c,3)==$.LI(h,3)&&(h+=.01),$.LI(d,3)==$.LI(g,3)&&(g+=.01),$.LI(f,3)==$.LI(b,3)&&(b+=.01);let N=this.get("controlPointDistance",.2);N=Math.min(.4999,N);let D=l+(u-l)*N*$.gn(k),L=c+(h-c)*N*$.F8(k),A=u-(u-l)*N*$.gn(w),I=h-(h-c)*N*$.F8(w),O=p+(m-p)*N*$.gn(k),j=_+(y-_)*N*$.F8(k),T=m-(m-p)*N*$.gn(w),S=y-(y-_)*N*$.F8(w),C=$._H({x:D,y:L},{x:A,y:I}),M=(v/$.gn(C)-v)/$.Ml(C)*$.gn(k),R=(v/$.F8(C)-v)*$.Ml(C)*$.F8(k),F=-M/2+d+(g-d)*N*$.gn(k),G=-R/2+f+(b-f)*N*$.F8(k),B=-M/2+g-(g-d)*N*$.gn(w),W=-R/2+b-(b-f)*N*$.F8(w);D+=M/2,L+=R/2,A+=M/2,I+=R/2,"vertical"==P?(L=Math.min(h,Math.max(c+1,L)),G=Math.min(b,Math.max(f+1,G)),I=Math.max(c,Math.min(h-1,I)),W=Math.max(f,Math.min(b-1,W))):(D=Math.min(u,Math.max(l+1,D)),F=Math.min(g,Math.max(d+1,F)),A=Math.max(l,Math.min(u-1,A)),B=Math.max(d,Math.min(g-1,B)));let E=[[l,c,d,f],[D,L,F,G],[A,I,B,W],[u,h,g,b]];this.set("draw",(e=>{const t=this.series;t._fillGenerator.context(e),t._fillGenerator(E)}));let H=[[p,_],[O,j],[T,S],[m,y]];const z=this.series._strokeGenerator(H);z&&(this._svgPath.setAttribute("d",z),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}getPoint(e){if(this._svgPath&&this._svgPath.getAttribute("d")){let t=this._svgPath.getPointAtLength(e*this._totalLength-.1),i=this._svgPath.getPointAtLength(e*this._totalLength+.1),n=this.toGlobal(this._svgPath.getPointAtLength(e*this._totalLength));return{x:n.x,y:n.y,angle:$._H(t,i)}}return{x:0,y:0,angle:0}}_getTooltipPoint(){return this.toLocal(super._getTooltipPoint())}}Object.defineProperty(he,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(he,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ie.classNames.concat([he.className])});var de=i(4439),ge=i(8640),fe=i(997),be=i(9884);function pe(e,t){let i=0;if(void 0===t)for(let t of e)(t=+t)&&(i+=t);else{let n=-1;for(let s of e)(s=+t(s,++n,e))&&(i+=s)}return i}function me(e,t){let i;if(void 0===t)for(const t of e)null!=t&&(i<t||void 0===i&&t>=t)&&(i=t);else{let n=-1;for(let s of e)null!=(s=t(s,++n,e))&&(i<s||void 0===i&&s>=s)&&(i=s)}return i}function _e(e,t){let i;if(void 0===t)for(const t of e)null!=t&&(i>t||void 0===i&&t>=t)&&(i=t);else{let n=-1;for(let s of e)null!=(s=t(s,++n,e))&&(i>s||void 0===i&&s>=s)&&(i=s)}return i}function ye(e){return e.target.depth}function ke(e){return e.depth}function we(e,t){return t-1-e.height}function ve(e,t){return e.sourceLinks.length?e.depth:t-1}function xe(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?_e(e.sourceLinks,ye)-1:0}function Pe(e){return function(){return e}}function Ne(e,t){return Le(e.source,t.source)||e.index-t.index}function De(e,t){return Le(e.target,t.target)||e.index-t.index}function Le(e,t){return e.y0-t.y0}function Ae(e){return e.value}function Ie(e){return e.index}function Oe(e){return e.nodes}function je(e){return e.links}function Te(e,t){const i=e.get(t);if(!i)throw new Error("missing: "+t);return i}function Se({nodes:e}){for(const t of e){let e=t.y0,i=e;for(const i of t.sourceLinks)i.y0=e+i.width/2,e+=i.width;for(const e of t.targetLinks)e.y1=i+e.width/2,i+=e.width}}function Ce(){let e,t,i,n=0,s=0,a=1,r=1,o=24,l=8,c=Ie,u=ve,h=Oe,d=je,g=6;function f(){const f={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return function({nodes:e,links:t}){for(const[t,i]of e.entries())i.index=t,i.sourceLinks=[],i.targetLinks=[];const n=new Map(e.map(((t,i)=>[c(t,i,e),t])));for(const[e,i]of t.entries()){i.index=e;let{source:t,target:s}=i;"object"!=typeof t&&(t=i.source=Te(n,t)),"object"!=typeof s&&(s=i.target=Te(n,s)),t.sourceLinks.push(i),s.targetLinks.push(i)}if(null!=i)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(i),n.sort(i)}(f),function({nodes:e}){for(const t of e)t.value=void 0===t.fixedValue?Math.max(pe(t.sourceLinks,Ae),pe(t.targetLinks,Ae)):t.fixedValue}(f),function({nodes:e}){const t=e.length;let i=new Set(e),n=new Set,s=0;for(;i.size;){for(const e of i){e.depth=s;for(const{target:t}of e.sourceLinks)n.add(t)}if(++s>t)throw new Error("circular link");i=n,n=new Set}}(f),function({nodes:e}){const t=e.length;let i=new Set(e),n=new Set,s=0;for(;i.size;){for(const e of i){e.height=s;for(const{source:t}of e.targetLinks)n.add(t)}if(++s>t)throw new Error("circular link");i=n,n=new Set}}(f),function(i){const c=function({nodes:e}){const i=me(e,(e=>e.depth))+1,s=(a-n-o)/(i-1),r=new Array(i);for(const t of e){const e=Math.max(0,Math.min(i-1,Math.floor(u.call(null,t,i))));t.layer=e,t.x0=n+e*s,t.x1=t.x0+o,r[e]?r[e].push(t):r[e]=[t]}if(t)for(const e of r)e.sort(t);return r}(i);e=Math.min(l,(r-s)/(me(c,(e=>e.length))-1)),function(t){const i=_e(t,(t=>(r-s-(t.length-1)*e)/pe(t,Ae)));for(const n of t){let t=s;for(const s of n){s.y0=t,s.y1=t+s.value*i,t=s.y1+e;for(const e of s.sourceLinks)e.width=e.value*i}t=(r-t+e)/(n.length+1);for(let e=0;e<n.length;++e){const i=n[e];i.y0+=t*(e+1),i.y1+=t*(e+1)}w(n)}}(c);for(let e=0;e<g;++e){const t=Math.pow(.99,e),i=Math.max(1-t,(e+1)/g);p(c,t,i),b(c,t,i)}}(f),Se(f),f}function b(e,i,n){for(let s=1,a=e.length;s<a;++s){const a=e[s];for(const e of a){let t=0,n=0;for(const{source:i,value:s}of e.targetLinks){let a=s*(e.layer-i.layer);t+=v(i,e)*a,n+=a}if(!(n>0))continue;let s=(t/n-e.y0)*i;e.y0+=s,e.y1+=s,k(e)}void 0===t&&a.sort(Le),m(a,n)}}function p(e,i,n){for(let s=e.length-2;s>=0;--s){const a=e[s];for(const e of a){let t=0,n=0;for(const{target:i,value:s}of e.sourceLinks){let a=s*(i.layer-e.layer);t+=x(e,i)*a,n+=a}if(!(n>0))continue;let s=(t/n-e.y0)*i;e.y0+=s,e.y1+=s,k(e)}void 0===t&&a.sort(Le),m(a,n)}}function m(t,i){const n=t.length>>1,a=t[n];y(t,a.y0-e,n-1,i),_(t,a.y1+e,n+1,i),y(t,r,t.length-1,i),_(t,s,0,i)}function _(t,i,n,s){for(;n<t.length;++n){const a=t[n],r=(i-a.y0)*s;r>1e-6&&(a.y0+=r,a.y1+=r),i=a.y1+e}}function y(t,i,n,s){for(;n>=0;--n){const a=t[n],r=(a.y1-i)*s;r>1e-6&&(a.y0-=r,a.y1-=r),i=a.y0-e}}function k({sourceLinks:e,targetLinks:t}){if(void 0===i){for(const{source:{sourceLinks:e}}of t)e.sort(De);for(const{target:{targetLinks:t}}of e)t.sort(Ne)}}function w(e){if(void 0===i)for(const{sourceLinks:t,targetLinks:i}of e)t.sort(De),i.sort(Ne)}function v(t,i){let n=t.y0-(t.sourceLinks.length-1)*e/2;for(const{target:s,width:a}of t.sourceLinks){if(s===i)break;n+=a+e}for(const{source:e,width:s}of i.targetLinks){if(e===t)break;n-=s}return n}function x(t,i){let n=i.y0-(i.targetLinks.length-1)*e/2;for(const{source:s,width:a}of i.targetLinks){if(s===t)break;n+=a+e}for(const{target:e,width:s}of t.sourceLinks){if(e===i)break;n-=s}return n}return f.update=function(e){return Se(e),e},f.nodeId=function(e){return arguments.length?(c="function"==typeof e?e:Pe(e),f):c},f.nodeAlign=function(e){return arguments.length?(u="function"==typeof e?e:Pe(e),f):u},f.nodeSort=function(e){return arguments.length?(t=e,f):t},f.nodeWidth=function(e){return arguments.length?(o=+e,f):o},f.nodePadding=function(t){return arguments.length?(l=e=+t,f):l},f.nodes=function(e){return arguments.length?(h="function"==typeof e?e:Pe(e),f):h},f.links=function(e){return arguments.length?(d="function"==typeof e?e:Pe(e),f):d},f.linkSort=function(e){return arguments.length?(i=e,f):i},f.size=function(e){return arguments.length?(n=s=0,a=+e[0],r=+e[1],f):[a-n,r-s]},f.extent=function(e){return arguments.length?(n=+e[0][0],a=+e[1][0],s=+e[0][1],r=+e[1][1],f):[[n,s],[a,r]]},f.iterations=function(e){return arguments.length?(g=+e,f):g},f}class Me extends b{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>he._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ue.new(this._root,{}))}),Object.defineProperty(this,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:Ce()}),Object.defineProperty(this,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,de.A)()}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,ge.A)()})}_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0((function(e){return e[3]})),this._fillGenerator.x0((function(e){return e[2]})),this._fillGenerator.y1((function(e){return e[1]})),this._fillGenerator.x1((function(e){return e[0]})),super._afterNew()}makeLink(e){const t=e.get("source"),i=e.get("target"),n=this.links.make();return t.get("unknown")&&(n.addTag("source"),n.addTag("unknown")),i.get("unknown")&&(n.addTag("target"),n.addTag("unknown")),this.linksContainer.children.push(n),n._setDataItem(e),n.set("source",t),n.set("target",i),n.series=this,this.links.push(n),n}updateSankey(){const e=this._d3Graph;e&&(this._d3Sankey.update(e),l.__(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()})))}_updateLinkColor(e){super._updateLinkColor(e);const t=this.get("orientation"),i=e.get("link")._fillGradient,n=e.get("link")._strokeGradient;"vertical"==t?(i&&i.set("rotation",90),n&&n.set("rotation",90)):(i&&i.set("rotation",0),n&&n.set("rotation",0))}_getBulletLocation(e){return"vertical"==this.get("orientation")?e.get("locationY",0):e.get("locationX",0)}_prepareChildren(){super._prepareChildren();let e=!1;if("vertical"==this.get("orientation")&&(e=!0),this.isDirty("orientation")||this.isDirty("linkTension")){const t=this.get("linkTension",.5);e?(this._fillGenerator.curve((0,be.w)(t)),this._strokeGenerator.curve((0,be.w)(t))):(this._fillGenerator.curve((0,fe.D)(t)),this._strokeGenerator.curve((0,fe.D)(t)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension")||this.isDirty("linkSort"))&&this._nodesData.length>0){const t=this._d3Sankey;let i=this.innerWidth(),n=this.innerHeight();switch(e&&([i,n]=[n,i]),t.size([i,n]),t.nodePadding(this.get("nodePadding",10)),t.nodeWidth(this.get("nodeWidth",10)),t.nodeSort(this.get("nodeSort",null)),t.linkSort(this.get("linkSort")),this.get("nodeAlign")){case"right":t.nodeAlign(we);break;case"justify":t.nodeAlign(ve);break;case"center":t.nodeAlign(xe);break;default:t.nodeAlign(ke)}this._d3Graph=t({nodes:this._nodesData,links:this._linksData}),l.__(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()}));const s=this._d3Graph;if(s){const t=s.nodes;l.__(t,(t=>{const i=t.dataItem,n=i.get("node");let s,a,r,o;e?(s=t.y0,a=t.y1,r=t.x0,o=t.x1):(s=t.x0,a=t.x1,r=t.y0,o=t.y1),f.Et(s)&&f.Et(a)&&f.Et(r)&&f.Et(o)&&(n.setAll({x:s,y:r,width:a-s,height:o-r}),i.get("rectangle").setAll({width:a-s,height:o-r}))}))}}}}Object.defineProperty(Me,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(Me,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:b.classNames.concat([Me.className])});var Re=i(4612);class Fe extends q{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>K.J._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"circles",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>Re.j._new(this._root,{themeTags:["shape"]},[this.circles.template])))})}makeNode(e){const t=super.makeNode(e,"ArcDiagram"),i=t.children.insertIndex(0,this.circles.make());e.set("circle",i),i._setSoft("fill",e.get("fill"));const n=this.labels.make();return this.labels.push(n),n.addTag("flow"),n.addTag("arcdiagram"),n.addTag("node"),t.children.push(n),e.set("label",n),n._setDataItem(e),i._setDataItem(e),t}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("circle");t&&(this.circles.removeValue(t),t.dispose())}_updateNodeColor(e){const t=e.get("circle");t&&t.set("fill",e.get("fill"))}}Object.defineProperty(Fe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagramNodes"}),Object.defineProperty(Fe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([Fe.className])});class Ge extends ie{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_radius",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const e=this.get("source");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("stroke")})))}}if(this.isDirty("target")){const e=this.get("target");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("stroke")})))}}if(this.isPrivateDirty("orientation")){const e=this.series,t=this.dataItem;t&&e&&e._updateLinkColor(t)}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem),"gradient"==this.get("strokeStyle")?this.set("isMeasured",!0):this.set("isMeasured",!1)}_changed(){super._changed(),this._clear&&this._draw()}_draw(){const e=this.get("target"),t=this.get("source");if(t&&e){let i=t.get("node"),n=e.get("node");const s=i.x(),a=i.y(),r=n.x(),o=n.y();this._p0={x:s,y:a},this._p1={x:r,y:o};let l=0;if("vertical"==this.getPrivate("orientation")){l=(o-a)/2;let e=1;a>o&&(e=-1),this._display.arc(s,a+l,l*e,-Math.PI/2,Math.PI/2)}else{l=(r-s)/2;let e=1;s>r&&(e=-1),this._display.arc(s+l,a,l*e,-Math.PI,0)}this._radius=l}}getPoint(e){if(this._p0&&this._p1){const t=this._radius;if("vertical"==this.getPrivate("orientation")){let i=180*e-90;return{y:this._p0.y+t+t*$.F8(i),x:t*$.gn(i),angle:i+90}}{let i=180+180*e;return{x:this._p0.x+t+t*$.gn(i),y:t*$.F8(i),angle:i+90}}}return{x:0,y:0,angle:0}}}Object.defineProperty(Ge,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagramLink"}),Object.defineProperty(Ge,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ie.classNames.concat([Ge.className])});class Be extends b{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new X.TS(Q.Bj.new({}),(()=>Ge._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Fe.new(this._root,{}))})}_afterNew(){this._settings.themeTags=se.kE(this._settings.themeTags,["arcdiagram",this._settings.orientation||"horizontal"]),super._afterNew(),this.nodes.children.push(this.bulletsContainer)}makeLink(e){const t=this.nodes.children.moveValue(this.links.make(),0);return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_prepareChildren(){if(super._prepareChildren(),this._valuesDirty||this._sizeDirty||this.isDirty("orientation")){let e=1;const t=this.get("orientation");l.__(this.dataItems,(e=>{e.get("link").setPrivate("orientation",this.get("orientation"))})),e="vertical"==t?this.innerHeight():this.innerWidth();let i=0,n=1/0,s=this.get("radiusKey");"none"!=s&&l.__(this.nodes.dataItems,(e=>{let t=e.get(s+"Working");i+=t,n=Math.min(n,t)}));const a=this.nodes.dataItems.length,r=this.get("nodePadding",10),o=this.get("minRadius",5);e-=a*(r+2*o),e<=0&&(e=0);let c=e/(i-a*n),u=0;const h=this.get("animationDuration",0),d=this.get("animationEasing");l.__(this.nodes.dataItems,(i=>{let l=i.get(s+"Working");const g=i.get("node");let f=o+c*(l-n)/2;if("none"==s&&(f=o+e/a/2),"vertical"==t){g.set("x",0);const e=u+r+f;0==g.y()?g.set("y",e):g.animate({key:"y",to:e,duration:h,easing:d})}else{g.set("y",0);const e=u+r+f;0==g.x()?g.set("x",e):g.animate({key:"x",to:e,duration:h,easing:d})}u=u+r+2*f,i.get("circle").set("radius",f)}))}}_updateLinkColor(e){super._updateLinkColor(e);const t=this.get("orientation"),i=e.get("link")._fillGradient,n=e.get("link")._strokeGradient;"vertical"==t?(i&&i.set("rotation",90),n&&n.set("rotation",90)):(i&&i.set("rotation",0),n&&n.set("rotation",0))}}Object.defineProperty(Be,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagram"}),Object.defineProperty(Be,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:b.classNames.concat([Be.className])})}}]);